#!/bin/bash

if [ -e build ]; then
	echo "Removing the existing build directory."
	rm -r build
fi

if [ "$1" == "--debug" ]; then
	echo "Preparing for a compilation in DEBUG mode." 
	echo
	cmake -Wno-dev -DCMAKE_BUILD_TYPE=Debug   -DCMAKE_Fortran_COMPILER=/usr/bin/gfortran-5 -DCMAKE_AR:PATH=/usr/bin/gcc-ar-5 -DCMAKE_RANLIB:PATH=/usr/bin/gcc-ranlib-5 -H. -Bbuild
elif [ "$1" == "--windows" ]; then
	echo "Preparing for a compilation in WINDOWS mode."
	echo
	cmake -Wno-dev -DCMAKE_BUILD_TYPE=Release -DCMAKE_Fortran_COMPILER=/usr/bin/x86_64-w64-mingw32-gfortran -DCMAKE_AR:PATH=/usr/bin/x86_64-w64-mingw32-gcc-ar -DCMAKE_RANLIB:PATH=x86_64-w64-mingw32-ranlib -DCMAKE_SYSTEM_NAME=Windows -H. -Bbuild
elif [ "$1" == "--fallback" ]; then
	echo "Preparing for a compilation in FALLBACK mode."
	echo
  module load gcc/4.9.1
	cmake -Wno-dev -DCMAKE_BUILD_TYPE=Release -H. -Bbuild
else
	echo "Preparing for a compilation in RELEASE mode."
	echo
	cmake -Wno-dev -DCMAKE_BUILD_TYPE=Release -DCMAKE_Fortran_COMPILER=/usr/bin/gfortran-5 -DCMAKE_AR:PATH=/usr/bin/gcc-ar-5 -DCMAKE_RANLIB:PATH=/usr/bin/gcc-ranlib-5 -H. -Bbuild
fi

echo
echo "Make has been initialized for compilation in the subdirectory 'build'."
echo "You can now type 'cd build' followed by 'make' to compile the project."
