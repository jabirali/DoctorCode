author:      Jabir Ali Ouassou
email:       jabirali@switzerlandmail.ch
output_dir:  ./documentation
project_dir: ./fortran/system
             ./fortran/foundation
             ./fortran/materials
             ./fortran/programs
extensions:  f
             i
summary:     s4tran â€” Superconducting Spintronics Simulation Suite in Fortran
graph:       false


Prerequisites
-------------
The only thing that is *really* necessary to compile the project, would be a
compiler that supports the Fortran standards from 1977 to 2008. But for your
own convenience, it is strongly recommended that you have these available:

 * [CMake](https://cmake.org/) (2.6+):
   a free, open-source, and cross-platform build system that automates the compilation details.
 * [GFortran](https://gcc.gnu.org/wiki/GFortran) (5.0+):
   a free, open-source, and cross-platform Fortran compiler from the GNU Compiler Collection.
 * [IFort](https://software.intel.com/en-us/fortran-compilers) (16.0+):
   a commercial Fortran compiler developed by Intel, with free licenses for 
   [students](https://software.intel.com/en-us/qualify-for-free-software/student) and
   [academics](https://software.intel.com/en-us/qualify-for-free-software/academicresearcher).

IFort generates much faster binaries than GFortran; for my simulation programs, we're
talking about a speedup of ~4x in benchmarks on an Intel Core i7 processor. I am
not really sure if this due to better vectorization, more aggressive inter-procedural
optimizations, or something else entirely. But the bottom line is that if you do have
access to an IFort licence, I strongly recommend using it. But if not, I *have* also 
tested the code extensively using only the free and open-source tools CMake and
GFortran, so having access to IFort should not be a necessity to use my programs.

Note that albeit slower, the binaries generated by GFortran can sometimes be more
stable than the ones generated by IFort; so if the programs exit with segmentation
faults, please send me a bug report, and try compiling with GFortran in the mean
time. Note also that the project *may* or *may not* compile using older versions
than GFortran 5.0 and IFort 16.0; I know that older versions of the code ran fine
using GFortran 4.9, but I haven't spent much time testing old compilers.



Compilation
------------
@NOTE
  These instructions should work for POSIX compliant operating systems with all 
  the above prerequisites installed. This should include Linux/Unix/Mac systems,
  and possibly also Windows if you have Cygwin installed. If you use any other 
  platforms or compilers than this, you may have to compile the project manually.

After you have obtained and unpacked the source code, open a terminal, and change
directory to the top directory of the project. This should be the directory with
the files `configure` and `CMakeLists.txt`. To prepare for compilation, you should
then run one of the following commands, depending on whether you wish to compile 
with GFortran or IFort:

    ./configure --gfortran
    ./configure --ifort

Hopefully, the code that you have obtained should be stable and reliable; but if you
need to search for bugs, it can be quite useful to compile the project in debug mode.
This disables all optimizations, and turns on safety checks both at compile-time and
run-time. To compile the project in debug mode, run one of these commands instead:

    ./configure --gfortran-debug
    ./configure --ifort-debug

After configuration, change to the subdirectory 'build', and run 'make' to compile:

    cd build
    make

If the project compiles successfully, the executables should appear in the subdirectory
`programs` of the top directory. 

Before running any serious simulations, you may also wish to run the unit tests:

    cd ..
    programs/test

Note also that this documentation is autogenerated. If you modify the sources and wish
to update the documentation accordingly, then just install the documentation generator
[FORD](https://github.com/cmacmackin/ford), and run the following command to regenerate:

    ./configure --doc


Usage
-----
Add something here about invoking the programs.




Other options
-------------
Other compilers have not been tested, and are not recommended. For instance, I use quite a few F2008 features
in my code, and at the time of this writing not all Fortran compilers support these features. If you really 
insist on using a different compiler, you probably want to invoke CMake directly instead of using the provided
configure script, and setting compiler flags manually (either using a tool like ccmake, or by using -DCMake
options when invoking it). In general, external/bvp_m.f is a fixed-form F77 file, the other external/\*.f are
free-form F90 files, and the rest of the \*.f files in the project are free-form F2008 files. The files \*.i
are directly included into \*.f files, and should not be compiled separately. Since a lot of compilers think
that all \*.f files are fixed-form format, you might need to consult your compilers manual, or rename the 
F90/F08 files to \*.f90.

A note on compiler options:
* Do not place all arrays on the stack (using -fno-stack-arrays with gfortran), as that has a tendency to cause segfaults.
* My code benefits a lot from interprocedural optimization due to the large number of function calls, so please compile
  with either -ipo under ifort or -flto under gfortran (this is the default in the CMake file).
* I compile with -Ofast under gfortran and -fast under intel. This includes some unsafe math optimizations, but since
  all my math is for finite numbers (no nan's or infinities), this is in my experience safe. Keep it on due to speed.


Example 
--------
This is a project which I wrote. This file will provide the documents. I'm
writing the body of the text here. It contains an overall description of the
project. It might explain how to go about installing/compiling it. It might
provide a change-log for the code. Maybe it will talk about the
history and/or motivation for this software.

@Note
You can include any notes (or bugs, warnings, or todos) like so.

You can have as many paragraphs as you like here and can use headlines, links,
images, etc. Basically, you can use anything in Markdown and Markdown-Extra.
Furthermore, you can insert LaTeX into your documentation. So, for example,
you can provide inline math using like \( y = x^2 \) or math on its own line
like \[ x = \sqrt{y} \] or $$ e = mc^2. $$ You can even use LaTeX environments!
So you can get numbered equations like this:
\begin{equation}
  PV = nRT
\end{equation}
So let your imagination run wild. As you can tell, I'm more or less just
filling in space now. This will be the last sentence.

Add some links.


